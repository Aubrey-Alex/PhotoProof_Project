<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频真实性验证系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container">
            <span class="navbar-brand mb-0 h1">视频真实性验证系统</span>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <div class="card">
                    <div class="card-header">
                        <h5>系统介绍</h5>
                    </div>
                    <div class="card-body">
                        <p>本系统可以验证视频在经过亮度调整、旋转、裁剪等变换后是否仍然保持真实性。</p>
                        <p><strong>支持的变换：</strong></p>
                        <ul>
                            <li>亮度变化 (±30%)</li>
                            <li>旋转 (±15°)</li>
                            <li>裁剪 (10%以内)</li>
                        </ul>
                        <p><strong>算法特点：</strong></p>
                        <ul>
                            <li>SIFT特征：对旋转、缩放不变</li>
                            <li>HSV直方图：对亮度变化鲁棒</li>
                            <li>Hu矩：对几何变换不变</li>
                            <li>频域特征：对空间变换鲁棒</li>
                        </ul>
                    </div>
                </div>

                <div class="card mt-4">
                    <div class="card-header">
                        <h5>快速演示</h5>
                    </div>
                    <div class="card-body">
                        <p>点击下方按钮体验系统自动演示功能：</p>
                        <a href="{{ url_for('demo') }}" class="btn btn-primary">开始演示</a>
                        <p class="text-muted mt-2">演示将自动创建测试视频，应用变换并验证真实性。</p>
                    </div>
                </div>

                <div class="card mt-4">
                    <div class="card-header">
                        <h5>自定义验证</h5>
                    </div>
                    <div class="card-body">
                        <form action="{{ url_for('upload_video') }}" method="post" enctype="multipart/form-data">
                            <div class="mb-3">
                                <label for="video" class="form-label">上传原始视频</label>
                                <input type="file" class="form-control" id="video" name="video" accept="video/*" required>
                                <div class="form-text">支持 MP4, AVI, MOV, MKV 格式，最大 100MB</div>
                                <div class="form-text">上传后将自动生成签名、创建变换视频并验证真实性</div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">变换参数设置</label>
                                <div class="row">
                                    <div class="col-md-4">
                                        <label for="brightness" class="form-label">亮度变化: <span id="brightness-value">0.1</span></label>
                                        <input type="range" class="form-range" id="brightness" name="brightness" min="-0.3" max="0.3" step="0.01" value="0.1">
                                        <div class="form-text">范围: -30% 到 +30%</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="rotation" class="form-label">旋转角度: <span id="rotation-value">5.0</span>°</label>
                                        <input type="range" class="form-range" id="rotation" name="rotation" min="-15" max="15" step="0.5" value="5.0">
                                        <div class="form-text">范围: -15° 到 +15°</div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="crop" class="form-label">裁剪比例: <span id="crop-value">0.05</span></label>
                                        <input type="range" class="form-range" id="crop" name="crop" min="0" max="0.1" step="0.005" value="0.05">
                                        <div class="form-text">范围: 0% 到 10%</div>
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success">上传并验证</button>
                        </form>
                    </div>
                </div>

                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        <div class="alert alert-info mt-3">
                            {% for message in messages %}
                                {{ message }}
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 更新滑块值显示
        document.getElementById('brightness').addEventListener('input', function() {
            document.getElementById('brightness-value').textContent = this.value;
        });
        document.getElementById('rotation').addEventListener('input', function() {
            document.getElementById('rotation-value').textContent = this.value;
        });
        document.getElementById('crop').addEventListener('input', function() {
            document.getElementById('crop-value').textContent = this.value;
        });
    </script>
</body>
</html>